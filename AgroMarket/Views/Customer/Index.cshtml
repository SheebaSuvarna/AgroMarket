@model CustomerDashboardViewModel
@{
    ViewData["Title"] = "Home";
}

    <style>

        body {
            font-family: 'Roboto', sans-serif;
            background-color: #f5f0e6;
            margin: 0;
            padding: 0;
        }

        .navbar {
            background-color: #4a5d23;
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-radius: 0 0 20px 20px;
        }

            .navbar .logo {
                color: #fff;
                font-size: 24px;
                font-weight: bold;
            }

            .navbar .cta {
                background-color: #f5a623;
                color: #fff;
                padding: 10px 20px;
                border-radius: 20px;
                text-decoration: none;
                font-weight: bold;
            }

        .hero {
            background-image: url('/BG1.png'); /* Use your local image */

            background-size: cover; /* Cover the entire div */

            background-position: center; /* Center the image */

            min-height: 400px; /* Minimum height to ensure visibility */

            padding: 50px 30px; /* Padding around the content */

            text-align: center;
            border-radius: 20px;
            margin: 20px;
            color: #fff; /* Change text color for better visibility */
        }

            .hero .cta {
                background-color: #f5a623;
                color: #fff;
                padding: 10px 20px;
                border-radius: 20px;
                text-decoration: none;
                font-weight: bold;
            }

        .hero-content {
            position: relative; /* Positioning for child elements */

            z-index: 2; /* Ensure text is above the background */
        }

        .hero h1, .hero p, .hero .cta {
            position: relative; /* Positioning for child elements */

            z-index: 2; /* Ensure text is above the background */
        }

        .content {
            display: flex;
            justify-content: space-between;
            padding: 30px;
        }

            .content .left, .content .right {
                width: 48%;
            }

                .content .left img, .content .right img {
                    width: 100%;
                    border-radius: 20px;
                }

                .content .left h2, .content .right h2 {
                    font-size: 24px;
                    color: #000;
                    margin: 20px 0 10px;
                }

                .content .left p, .content .right p {
                    font-size: 16px;
                    color: #000;
                    margin: 0 0 20px;
                }

        .search-form {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 20px; /* Add margin to space it below the other content */
        }

        .content .left .cta, .content .right .cta {
            background-color: #f5a623;
            color: #fff;
            padding: 10px 20px;
            border-radius: 20px;
            text-decoration: none;
            font-weight: bold;
            display: inline-block;
        }

        .form-group label {
            font-weight: bold;
            margin-right: 5px;
        }

        .form-group select {
            width: auto;
            display: inline-block;
        }
    </style>

    <div class="hero">
        <div class="hero-content">
            <h1>Welcome to Our Store!</h1>
            <p>Your Marketplace for Fresh Produce</p>
            <a class="cta" href="#">Get it Now</a>
            <!-- Search Bar -->
            <form method="get" action="@Url.Action("Index")" class="form-inline search-form" onsubmit="sortProducts(); return false;">
                <input class="form-control mr-2" name="searchTerm" type="search" placeholder="Search" value="@ViewBag.SearchTerm" aria-label="Search" style="width: 300px; height: 40px;">
                <button class="btn btn-outline-success" type="submit" style="height: 40px;background: #4a5d23;">Search</button>
            </form>

        </div>
    </div>


    <!-- Available Products Section -->
    <h3 class="text-center text-muted mb-4">Available Products</h3>

    <!-- Filter and Sort Options -->
    <div class="row mb-4 justify-content-end">
        <div class="col-md-8 d-flex justify-content-end align-items-center">
            <!-- Category Dropdown -->
            <div class="form-group mr-3">
                <label for="categoryId" class="mr-2">Select Category:</label>
                <select id="categoryId" name="categoryId" class="form-control" onchange="sortProducts()">
                    <option value="">All Categories</option>
                    @foreach (var category in ViewBag.Categories)
                    {
                        if (@category.Text == ViewBag.SelectedCategory)
                        {
                            <option value="@category.Text" selected>@category.Text</option>
                        }
                        else
                        {
                            <option value="@category.Text">@category.Text</option>
                        }
                    }
                </select>
            </div>

            <!-- Sort By Dropdown -->
            <div class="form-group">
                <label for="sortDropdown" class="mr-2">Sort By:</label>
                <select id="sortDropdown" class="form-control" onchange="sortProducts()">
                    @if (ViewBag.SortOrder == "popularity")
                    {
                        <option value="popularity" selected>Popularity</option>
                    }
                    else
                    {
                        <option value="popularity">Popularity</option>
                    }

                    @if (ViewBag.SortOrder == "price_low_high")
                    {
                        <option value="price_low_high" selected>Price -- Low to High</option>
                    }
                    else
                    {
                        <option value="price_low_high">Price -- Low to High</option>
                    }

                    @if (ViewBag.SortOrder == "price_high_low")
                    {
                        <option value="price_high_low" selected>Price -- High to Low</option>
                    }
                    else
                    {
                        <option value="price_high_low">Price -- High to Low</option>
                    }

                    @if (ViewBag.SortOrder == "newest")
                    {
                        <option value="newest" selected>Newest First</option>
                    }
                    else
                    {
                        <option value="newest">Newest First</option>
                    }
                </select>
            </div>
        </div>
    </div>


    <script>
        function sortProducts() {
            // Get selected sort value
            var selectedSort = document.getElementById("sortDropdown").value;
            var selectedCategory = document.getElementById("categoryId").value;

            // Get search term from the search input field
            var searchTerm = document.querySelector("input[name='searchTerm']").value;

            // Build the URL using URLSearchParams to encode the query parameters
            var params = new URLSearchParams({
                searchTerm: searchTerm,
                sortOrder: selectedSort,
                categoryName: selectedCategory
            });

            // Redirect to the new URL with the selected sorting option
            window.location.href = '@Url.Action("Index", "Customer")' + '?' + params.toString();
        }

    </script>
    <style>
        .sort-options a {
            text-decoration: none;
            color: #6c757d;
            transition: color 0.2s;
        }

            .sort-options a:hover {
                color: #007bff;
            }

            .sort-options a.text-primary.font-weight-bold {
                color: #007bff;
                font-weight: bold;
            }

    </style>
    <div class="row">
        @foreach (var product in Model.Products)
        {
            <div class="col-md-4 mb-4">
                <div class="card h-100 shadow-sm border-0 rounded-lg overflow-hidden">
                    <img src="@product.ImageUrl" class="card-img-top img-fluid" alt="@product.ProductName" style="height: 250px; object-fit: cover;" />

                    <div class="card-body d-flex flex-column p-4">
                        <h5 class="card-title text-primary mb-3">@product.ProductName</h5>
                        <p class="card-text text-success font-weight-bold">Price: @product.Price.ToString("C")</p>
                        <p class="card-text text-success font-weight-bold">Stock Quantity: @product.StockQuantity</p>

                        <!-- Include the reusable partial view here -->
                        @Html.Partial("_QuantityControlAndAddToCart", product)

                        <a href="@Url.Action("ProductDetails", "Product", new { id = product.ProductID })" class="btn btn-outline-info btn-block mt-3">
                            View Details
                        </a>
                    </div>
                </div>
            </div>
        }

    </div>

    <!-- Available Products Section -->
    <h3 class="text-center text-muted mb-4"> About Us</h3>
    <div class="content">
        <div class="left">
            <img src="https://storage.googleapis.com/a1aa/image/5YGp6CA42JqPLdiifiytWh9eurHRACEQn3RdQSPIDCMTWRlTA.jpg" alt="Farmer in a field with various vegetables">
            <h2>Fresh Products</h2>
            <p>Bringing the farm to your table! Shop from local farmers and enjoy fresh, quality produce delivered straight to your doorstep..</p>
            <a class="cta" href="#">Buy Now</a>
        </div>
        <div class="right">
            <div >
                <h2>Fresh Products</h2>
                <p>Bringing the farm to your table! Shop from local farmers and enjoy fresh, quality produce delivered straight to your doorstep..</p>
                <a class="cta" href="#">Buy Now</a>
            </div>
        <h2></h2>
            <img src="https://storage.googleapis.com/a1aa/image/75fbebSV8XiFzkSWAfPQao7PQ8aQq1yinq9EDS2QSbWksiKnA.jpg" alt="Basket of fresh produce" >
            <h2></h2>
            
        </div>
    </div>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" />

    <!-- Enhanced Styles -->
    <style>
        /* Page Title Styling */
        h2 {
            font-weight: bold;
            color: #2c3e50;
        }

        /* Card Styling */
        .card {
            transition: transform 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
        }

            .card:hover {
                transform: translateY(-5px);
                box-shadow: 0 12px 18px rgba(0, 0, 0, 0.1);
            }

        /* Product Title Styling */
        .card-title {
            font-size: 1.25rem;
            font-weight: 600;
        }

        /* Product Description */
        .card-text {
            font-size: 0.95rem;
            color: #6c757d;
        }

            /* Price Styling */
            .card-text.font-weight-bold {
                font-size: 1.1rem;
                color: #28a745;
            }

        /* Button Styling */
        .btn-primary {
            background-color: #007bff;
            border-color: #007bff;
            transition: background-color 0.2s ease, border-color 0.2s ease;
        }

            .btn-primary:hover {
                background-color: #0056b3;
                border-color: #0056b3;
            }

        .btn-outline-secondary {
            transition: all 0.2s ease;
        }

            .btn-outline-secondary:hover {
                background-color: #6c757d;
                color: #fff;
            }

        /* Input Styling */
        .form-control {
            border-radius: 0.25rem;
            font-size: 1rem;
        }

        /* Label Styling */
        label {
            font-weight: 500;
            color: #495057;
        }
    </style>
