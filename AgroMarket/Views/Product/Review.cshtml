@model IEnumerable<AgroMarket.Models.Entities.Product>

<style>
    /* Additional styles to match the previous design */
    #product-review-list {
        max-width: 800px; /* Set a max width for the list */
        margin: auto; /* Center the product review list */
    }

    .card {
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        border: none;
        border-radius: 15px;
    }

    .card-header {
        background-color: #4a6fdc;
        border-radius: 15px 15px 0 0 !important;
        padding: 10px; /* Adjusted padding */
    }

    .card-body {
        padding: 15px; /* Consistent padding */
    }

    .rating-stars {
        margin-bottom: 10px; /* Spacing between stars and other content */
    }

    .no-products-message {
        text-align: center;
        font-size: 18px;
        color: #495057;
        margin: 20px 0;
    }

    .no-products-icon {
        max-width: 150px; /* Set a max width for the icon */
        margin-bottom: 15px; /* Spacing below the icon */
    }

    .add-product-button {
        text-align: center;
        margin-top: 20px;
    }
</style>

<div id="product-review-list">
    @if (Model == null || !Model.Any())
    {
        <div class="text-center">
            <img src="/no-products-found.png" alt="No Products Found" class="no-products-icon" />
            <div class="add-product-button">
                <a asp-action="Create" class="btn btn-primary">
                    <i class="fas fa-plus-circle me-2"></i> Add Product
                </a>
            </div>
        </div>
    }
    else
    {
        foreach (var product in Model)
        {
            <div class="card mb-3">
                <div class="card-header">
                    <h5 class="card-title">@product.ProductName</h5>
                </div>
                <div class="card-body">
                    <img src="@product.ImageUrl" alt="@product.ProductName" class="card-img-top" style="max-width: 200px; max-height: 200px;" />
                    
                    @if (product.Review.Any())
                    {
                        var average = product.Review.Average(r => r.Rating);
                        <h6>Average Rating: @average </h6>
                        <div class="rating-stars mb-3">
                            @for (int i = 1; i <= 5; i++)
                            {
                                if (i <= Math.Floor(@average))
                                {
                                    <i class="fas fa-star" style="color: #ffc107;"></i> <!-- Full Star -->
                                }
                                else if (i == Math.Ceiling(average))
                                {
                                    <i class="fas fa-star-half-alt" style="color: #ffc107;"></i> <!-- Half Star -->
                                }
                                else
                                {
                                    <i class="far fa-star" style="color: #ffc107;"></i> <!-- Empty Star -->
                                }
                            }
                        </div>

                        <ul class="list-unstyled">
                            @foreach (var review in product.Review)
                            {
                                <li class="border-bottom mb-2">
                                    <div>Rating: @review.Rating</div>

                                    <div class="rating-stars mb-3">
                                        @for (int i = 1; i <= 5; i++)
                                        {
                                            if (i <= review.Rating)
                                            {
                                                <i class="fas fa-star" style="color: #ffc107;"></i> <!-- Full Star -->
                                            }
                                            else
                                            {
                                                <i class="far fa-star" style="color: #ffc107;"></i> <!-- Empty Star -->
                                            }
                                        }
                                    </div>
                                    <p>@review.Comment</p>
                                    <small>@review.CreatedAt.ToShortDateString()</small>
                                </li>
                            }
                        </ul>
                    }
                    else
                    {
                        <p>No reviews available.</p>
                    }
                </div>
            </div>
        }
    }
</div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<!-- Add Font Awesome for star icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" />
